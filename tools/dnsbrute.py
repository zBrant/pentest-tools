import sys
import threading

import dns.resolver


subdominios = []


def read_list(wordlist):
    global subdominios
    try:
        with open(wordlist, "r") as arq:
            subdominios = arq.read().splitlines()
    except:
        print("wordlist not found")
        sys.exit()


def requests():
    resolver = dns.resolver.Resolver()
    for subdominio in subdominios:
        try:
            subdominios.pop(0)
            sub_alvo = "{}.{}".format(subdominio, alvo)
            resultados = resolver.resolve(sub_alvo, "A")
            for resultado in resultados:
                print("{} -> {}".format(sub_alvo, resultado))
        except KeyboardInterrupt:
            exit()
        except:
            print("subdominio [ {} ] not found".format(subdominio))


if __name__ == "__main__":
    if len(sys.argv) == 3:
        alvo = sys.argv[1]
        wordlist = sys.argv[2]
        read_list(wordlist)

        THREADS = []
        for i in range(15):
            THREADS.append(threading.Thread(target=requests))

        for t in THREADS:
            t.start()
    else:
        print("Usage: python dnsbrute.py dominio wordlist.txt")
        sys.exit()
