import socket
import sys


def init_server(port):
    try:
        server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        server.bind(("0.0.0.0", int(port)))
        server.listen(1)

        print("Listening... ")
        file = open("mensages received", "w")

        client_socket, address = server.accept()
        data = client_socket.recv(1024).decode()
        file.write(data)
        server.close()
    except OSError as e:
        print(e)
        print("Error, something is wrong.")


if __name__ == "__main__":
    if len(sys.argv) == 2:
        init_server(sys.argv[1])
    else:
        print("Usage: python server_tcp [specify port to listen]")
