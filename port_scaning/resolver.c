#include <stdio.h>
#include <netdb.h>
#include <arpa/inet.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>


void requests(char *alvo, char list[]){
	struct hostent *host;
	char *result;
	char txt[50];
	FILE *wordlist = fopen(list, "r");


	while(fscanf(wordlist, "%s", &txt) != EOF){
		result = (char *) strcat(txt,alvo);
		host = gethostbyname(result);
		if(host == NULL){
			continue;
		}
		printf("FOUND HOST: %s ---> IP: %s \n",result, inet_ntoa(*((struct in_addr *)host->h_addr)));
	}
}


int main(int argc, char *argv[]){
	
	if(argc < 3){
		printf("Usage: ./resolver [hostname] [wordlist.txt]");
	}else{
		requests(argv[1], argv[2]);
	}

	return 0;
}
